# Домашнее задание к занятию "`Кеширование Redis/memcached`" - `Дёмин Максим`


### Задание 1

Что нужно сделать:

Кеширование

Приведите примеры проблем, которые может решить кеширование.

Приведите ответ в свободной форме.

### Решение:

Кеширование помогает решить такие проблемы:

Медленная работа из-за частых одинаковых запросов к базе/сервисам.

Пример: сайт постоянно запрашивает топ товаров или профиль пользователя. Вместо обращения в БД каждый раз - сохраняем результат в кеш и читаем оттуда быстрее.

Большая нагрузка на БД и рост затрат на инфраструктуру.

Пример: много пользователей одновременно обновляют страницу - БД перегружается. Кеш снимает часть нагрузки, потому что часть данных отдается из памяти.

Высокая задержка (latency) из-за медленных внешних API.

Пример: сервис тянет курс валют или погоду по API. Можно кешировать ответ на 1-5 минут, чтобы не дергать API постоянно и не ловить лимиты.

Пики трафика и необходимость стабилизировать систему.

Пример: во время акции/распродажи запросы резко растут. Кеш позволяет системе пережить пик, отдавая повторяющиеся данные из памяти.

Снижение количества вычислений.

Пример: тяжелые отчеты/агрегации/рендеры можно кешировать на некоторое время


### Задание 2

Что нужно сделать:

Memcached

Установите и запустите memcached.

Приведите скриншот systemctl status memcached, где будет видно, что memcached запущен.

### Решение:

1 Установить memcached: (sudo apt install -y memcached)[img/01.png]

```
sudo apt install -y memcached
Следующие пакеты устанавливались автоматически и больше не требуются:
  libdrm-radeon1:i386  libgl1-amber-dri  libglapi-amber  libllvm19:i386  libuuid1:i386  libwayland-server0:i386  libxcb-dri2-0:i386  lp-solve  postgresql-common-dev
Для их удаления используйте «sudo apt autoremove».

К установке:
  memcached

Предлагаемые пакеты:
  libanyevent-perl  libcache-memcached-perl  libmemcached  libyaml-perl

Сводка:
  К обновлению: 0, К установке: 1 К удалению: 0, Не обновляется: 0
  Размер загрузки: 213 kB
  Места необходимо: 605 kB / 3 746 MB доступно

Пол:1 http://archive.ubuntu.com/ubuntu noble/main amd64 memcached amd64 1.6.24-1build3 [213 kB]
Получено 213 kB за 2с (103 kB/s)          
Выбор ранее не выбранного пакета memcached.
(Чтение базы данных … на данный момент установлено 470893 файла и каталога.)
Подготовка к распаковке …/memcached_1.6.24-1build3_amd64.deb …
Распаковывается memcached (1.6.24-1build3) …
Настраивается пакет memcached (1.6.24-1build3) …
Created symlink '/etc/systemd/system/multi-user.target.wants/memcached.service' → '/usr/lib/systemd/system/memcached.service'.
Обрабатываются триггеры для man-db (2.12.1-3) …
```

2 Включить автозапуск и запустить сервис: sudo systemctl enable --now memcached

3 Проверить статус systemctl status memcached / systemctl status memcached --no-pager



### Задание 3

Что нужно сделать:

Удаление по TTL в Memcached

Запишите в memcached несколько ключей с любыми именами и значениями, для которых выставлен TTL 5.

Приведите скриншот, на котором видно, что спустя 5 секунд ключи удалились из базы.

### Решение:

1 Memcached текстовый протокол:

set <key> <flags> <exptime> <bytes>

printf "set key1 0 5 5\r\nhello\r\nset key2 0 5 5\r\nworld\r\nget key1\r\nget key2\r\nquit\r\n" | nc 127.0.0.1 11211

2 Подождать 6 секунд: sleep 6

3 Проверить, что ключи исчезли: printf "get key1\r\nget key2\r\nquit\r\n" | nc 127.0.0.1 11211



### Задание 4

Что нужно сделать:

 Запись данных в Redis
 
Запишите в Redis несколько ключей с любыми именами и значениями.

Через redis-cli достаньте все записанные ключи и значения из базы, приведите скриншот этой операции.

### Решение:

1 Установить Redis sudo apt install -y redis-server
2 Запустить и включить автозапуск: sudo systemctl enable --now redis-server
3 Открыть redis-cli: redis-cli
4 Записать несколько ключей ```SET name "Maxim "SET city "SPb" SET course "Netology-Redis"```
5 Посмотреть все ключи: KEYS *
6 Посмотреть значения: MGET name city course
7 Выйти exit


### Задание 5

Что нужно сделать:

Работа с числами

Запишите в Redis ключ key5 со значением типа "int" равным числу 5. Увеличьте его на 5, чтобы в итоге в значении лежало число 10.

Приведите скриншот, где будут проделаны все операции и будет видно, что значение key5 стало равно 10.

### Решение:

1 ключ key5 со значением 5: SET key5 5

2 увеличить на 5: INCRBY key5 5

3 проверить значение: GET key5
